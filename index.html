<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estimateur Budget Recrutement</title>
    <style>
        .budget-estimator {
            max-width: 500px;
            background: white;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 14px;
            border: 1px solid #e2e8f0;
        }

        .estimator-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .estimator-header h3 {
            margin: 0 0 8px 0;
            color: #1e293b;
            font-size: 20px;
            font-weight: 700;
        }

        .estimator-header p {
            margin: 0 0 16px 0;
            color: #64748b;
            font-size: 13px;
            line-height: 1.5;
        }

        .methodology-link {
            font-size: 11px;
            color: #3b82f6;
            text-decoration: none;
            cursor: pointer;
        }

        .methodology-link:hover {
            text-decoration: underline;
        }

        .company-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .company-btn {
            padding: 10px 6px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            font-size: 11px;
        }

        .company-btn:hover {
            border-color: #6366f1;
            background: #f8fafc;
        }

        .company-btn.active {
            background: #6366f1;
            color: white;
            border-color: #6366f1;
        }

        .input-section {
            background: #f8fafc;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 12px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-size: 12px;
            color: #374151;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .input-group input, .input-group select {
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 13px;
            background: white;
            transition: border-color 0.2s;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .help-text {
            font-size: 10px;
            color: #6b7280;
            margin-top: 2px;
            font-style: italic;
        }

        .results-section {
            margin-top: 24px;
        }

        .roi-highlight {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.3);
        }

        .roi-highlight.negative {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            box-shadow: 0 4px 20px rgba(245, 158, 11, 0.3);
        }

        .roi-value {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .roi-text {
            font-size: 13px;
            opacity: 0.95;
            margin-bottom: 4px;
        }

        .roi-subtitle {
            font-size: 11px;
            opacity: 0.8;
        }

        .comparison-results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .cost-card {
            padding: 18px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .cost-card h4 {
            margin: 0 0 8px 0;
            font-size: 13px;
            font-weight: 600;
        }

        .cost-amount {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .cost-breakdown {
            font-size: 10px;
            opacity: 0.8;
        }

        .method-current {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fbbf24;
        }

        .method-tenex {
            background: #e0e7ff;
            color: #3730a3;
            border: 1px solid #6366f1;
        }

        .bad-hire-section {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border: 1px solid #fecaca;
            padding: 16px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .bad-hire-title {
            font-size: 13px;
            font-weight: 600;
            color: #991b1b;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .bad-hire-calc {
            font-size: 11px;
            color: #7f1d1d;
            line-height: 1.4;
        }

        .bad-hire-savings {
            font-weight: 600;
            color: #991b1b;
        }

        .plan-suggestion {
            background: #f9fafb;
            border: 1px solid #d1d5db;
            padding: 16px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .plan-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .cta-section {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
        }

        .cta-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .cta-subtitle {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 16px;
        }

        .cta-button {
            background: white;
            color: #6366f1;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .cta-button:hover {
            background: #f8fafc;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .disclaimer {
            font-size: 10px;
            color: #6b7280;
            text-align: center;
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid #e5e7eb;
            font-style: italic;
        }

        .hidden { display: none; }

        .methodology-popup {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .methodology-content {
            background: white;
            padding: 24px;
            border-radius: 12px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            margin: 20px;
        }

        .close-btn {
            float: right;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #6b7280;
        }

        .debug-info {
            background: #f3f4f6;
            padding: 12px;
            border-radius: 8px;
            font-size: 11px;
            margin-top: 16px;
            border: 1px solid #d1d5db;
        }
    </style>
</head>
<body>
    <div class="budget-estimator">
        <div class="estimator-header">
            <h3>📊 Estimateur Budget Recrutement</h3>
            <p>Calculez votre ROI et comparez les méthodes de recrutement</p>
            <a href="#" class="methodology-link" onclick="showMethodology()">📋 Voir la méthodologie et les sources</a>
        </div>

        <div>
        <div class="company-grid">
                <button class="company-btn" data-type="tpe">TPE<br><span style="font-size: 9px;">1-9 sal.</span></button>
                <button class="company-btn" data-type="petite-pme">PME<br><span style="font-size: 9px;">10-49 sal.</span></button>
                <button class="company-btn" data-type="moyenne-pme">PME+<br><span style="font-size: 9px;">50-249 sal.</span></button>
                <button class="company-btn" data-type="eti">ETI<br><span style="font-size: 9px;">250-4999 sal.</span></button>
                <button class="company-btn" data-type="grande">Grande<br><span style="font-size: 9px;">5000+ sal.</span></button>
                <button class="company-btn" data-type="startup">Startup<br><span style="font-size: 9px;">Croissance</span></button>
            </div>

            <div id="params" class="hidden">
                <div class="input-section">
                    <div class="input-row">
                        <div class="input-group">
                            <label>Recrutements annuels</label>
                            <input type="number" id="jobs" min="1" value="5">
                            <span class="help-text">Nombre de postes à pourvoir</span>
                        </div>
                        <div class="input-group">
                            <label>Salaire moyen (k€)</label>
                            <input type="number" id="salary" min="20" value="45">
                            <span class="help-text">Salaire brut annuel moyen</span>
                        </div>
                    </div>

                    <div class="input-row">
                        <div class="input-group">
                            <label>Méthode actuelle</label>
                            <select id="method">
                                <option value="cabinet">Cabinet de recrutement</option>
                                <option value="interne">Interne + Jobboards</option>
                                <option value="ats">ATS existant + Jobboards</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label id="costLabel">Commission (%)</label>
                            <input type="number" id="cost" value="18">
                            <span class="help-text" id="costHelp">Taux de commission moyen</span>
                        </div>
                    </div>

                    <div class="input-row">
                        <div class="input-group">
                            <label>Temps RH/recrutement (h)</label>
                            <input type="number" id="timeHr" value="20">
                            <span class="help-text">Sourcing + entretiens + admin</span>
                        </div>
                        <div class="input-group">
                            <label>Coût horaire RH (€)</label>
                            <input type="number" id="hrRate" value="25">
                            <span class="help-text">Salaire + charges + indirects</span>
                        </div>
                    </div>

                    <div class="input-row">
                        <div class="input-group">
                            <label>Coût mauvais recrutement (k€)</label>
                            <input type="number" id="badHireCost" value="30">
                            <span class="help-text">Coût d'un échec de recrutement</span>
                        </div>
                        <div class="input-group">
                            <label>Risque mauvais recrutement (%)</label>
                            <input type="number" id="badHireRate" value="15">
                            <span class="help-text">% d'échecs méthode actuelle</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="result" class="hidden">
            <div class="results-section">
                <!-- ROI HIGHLIGHT -->
                <div class="roi-highlight" id="roiHighlight">
                    <div class="roi-value" id="roiValue">+245%</div>
                    <div class="roi-text">Retour sur investissement</div>
                    <div class="roi-subtitle" id="roiSubtitle">Pour chaque 1€ investi, vous économisez 2,45€</div>
                </div>

                <!-- COMPARISON -->
                <div class="comparison-results">
                    <div class="cost-card method-current">
                        <h4 id="currentMethodTitle">Méthode actuelle</h4>
                        <div class="cost-amount" id="currentCost">0 €</div>
                        <div class="cost-breakdown" id="currentBreakdown">Par an</div>
                    </div>
                    <div class="cost-card method-tenex">
                        <h4>Avec Tenex</h4>
                        <div class="cost-amount" id="tenexCost">0 €</div>
                        <div class="cost-breakdown">Abonnement + temps RH</div>
                    </div>
                </div>

                <!-- MAUVAIS RECRUTEMENT -->
                <div class="bad-hire-section">
                    <div class="bad-hire-title">
                        ⚠️ Coût des mauvais recrutements
                    </div>
                    <div class="bad-hire-calc" id="badHireCalc">
                        Avec votre méthode actuelle : 15% d'échec × 5 recrutements × 30k€ = <span class="bad-hire-savings">22 500€</span> de risque/an
                        <br>Avec Tenex (5% d'échec grâce à l'IA) : <span class="bad-hire-savings">7 500€</span> de risque/an
                        <br><strong>Économie sur le risque : 15 000€/an</strong>
                    </div>
                </div>

                <!-- PLAN SUGGESTION -->
                <div class="plan-suggestion">
                    <div class="plan-name" id="planName">Plan recommandé</div>
                    <div id="planDetails" style="font-size: 12px; color: #6b7280;"></div>
                </div>

                <!-- DEBUG INFO -->
                <div class="debug-info" id="debugInfo" style="display: none;">
                    <strong>Debug Info:</strong><br>
                    <span id="debugText"></span>
                </div>

                <!-- CTA -->
                <div class="cta-section">
                    <div class="cta-title">🎯 Voir vos chiffres réels</div>
                    <div class="cta-subtitle">Obtenez une analyse personnalisée de vos coûts de recrutement</div>
                    <a href="#" class="cta-button" onclick="trackCTA()">👉 Réserver une démo gratuite</a>
                </div>
            </div>
        </div>

        <div class="disclaimer">
            <strong>Outil d'estimation uniquement.</strong> Les coûts réels peuvent varier selon votre contexte spécifique. 
            <br>Données basées sur études marché 2024 et retours clients.
            <br><a href="#" onclick="toggleDebug()" style="color: #6b7280;">🔧 Mode debug</a>
        </div>
    </div>

    <!-- Methodology Popup -->
    <div class="methodology-popup" id="methodologyPopup">
        <div class="methodology-content">
            <button class="close-btn" onclick="hideMethodology()">&times;</button>
            <h3>📋 Méthodologie de calcul</h3>
            
            <h4>🏢 Cabinet de recrutement</h4>
            <ul style="font-size: 12px; margin-bottom: 16px;">
                <li><strong>Commission :</strong> 15-20% du salaire brut annuel (source : étude Apec 2024)</li>
                <li><strong>Temps RH :</strong> 5h en moyenne (validation candidats + intégration)</li>
                <li><strong>Échec :</strong> 15% selon études sectorielles</li>
            </ul>

            <h4>🔍 Recrutement interne + Jobboards</h4>
            <ul style="font-size: 12px; margin-bottom: 16px;">
                <li><strong>Jobboards :</strong> 800-1300€/poste selon taille entreprise</li>
                <li><strong>Temps RH :</strong> 15-25h/recrutement (sourcing, tri CV, entretiens)</li>
                <li><strong>Échec :</strong> 15-20% (manque de temps pour bien qualifier)</li>
            </ul>

            <h4>💻 ATS existant + Jobboards</h4>
            <ul style="font-size: 12px; margin-bottom: 16px;">
                <li><strong>Coût ATS :</strong> 50-150€/recrutement (TPE/PME) • 100-400€ (PME/ETI) • 200-800€ (Grandes entreprises)</li>
                <li><strong>Jobboards :</strong> MÊME budget que l'interne (l'ATS n'élimine pas ce coût)</li>
                <li><strong>Temps RH :</strong> 20% de temps économisé grâce à l'organisation ATS</li>
                <li><strong>Échec :</strong> 13% (meilleur suivi candidats)</li>
                <li><strong>⚠️ Important :</strong> ATS = coût ADDITIONNEL au recrutement interne</li>
            </ul>

            <h4>✨ Avec Tenex</h4>
            <ul style="font-size: 12px; margin-bottom: 16px;">
                <li><strong>Abonnement :</strong> Plans 249€ à 799€/mois selon volume de recrutements</li>
                <li><strong>Temps RH réduit :</strong> 5-8h grâce à l'IA et au matching automatique</li>
                <li><strong>Jobboards inclus :</strong> Multidiffusion automatique sur +15 plateformes</li>
                <li><strong>Taux d'échec :</strong> 5-7% grâce au matching IA + tests intégrés + scoring prédictif</li>
                <li><strong>Avantage :</strong> IA générative, qualification automatique, matching intelligent</li>
            </ul>

            <h4>💰 Calcul du ROI</h4>
            <ul style="font-size: 12px; margin-bottom: 16px;">
                <li><strong>ROI = (Économies totales - Coût Tenex) / Coût Tenex × 100</strong></li>
                <li><strong>Économies totales :</strong> Coût actuel - Coût Tenex + Réduction risque mauvais recrutement</li>
                <li><strong>Coût mauvais recrutement :</strong> 30k€ en moyenne (formation, management, remplacement, perte productivité)</li>
            </ul>

            <h4>⚠️ Limites de l'estimation</h4>
            <ul style="font-size: 11px; color: #6b7280;">
                <li>Coûts variables selon secteur et localisation</li>
                <li>Taux d'échec dépendant qualité du processus RH</li>
                <li>Coût mauvais recrutement variable selon poste</li>
                <li>Estimation indicative, non contractuelle</li>
            </ul>
        </div>
    </div>

    <script>
        const profiles = {
            'tpe': { jobs: 2, salary: 35, method: 'interne', cost: 1300, hrRate: 60, timeHr: 15, atsCost: 150, jobboardCost: 1300, badHireCost: 25, badHireRate: 18 },
            'petite-pme': { jobs: 4, salary: 40, method: 'interne', cost: 1100, hrRate: 20, timeHr: 20, atsCost: 200, jobboardCost: 1100, badHireCost: 28, badHireRate: 17 },
            'moyenne-pme': { jobs: 8, salary: 45, method: 'interne', cost: 1000, hrRate: 22, timeHr: 20, atsCost: 300, jobboardCost: 1000, badHireCost: 30, badHireRate: 16 },
            'eti': { jobs: 20, salary: 50, method: 'interne', cost: 900, hrRate: 25, timeHr: 22, atsCost: 400, jobboardCost: 900, badHireCost: 35, badHireRate: 15 },
            'grande': { jobs: 50, salary: 55, method: 'ats', cost: 600, hrRate: 30, timeHr: 25, atsCost: 600, jobboardCost: 800, badHireCost: 40, badHireRate: 13 },
            'startup': { jobs: 12, salary: 48, method: 'interne', cost: 1200, hrRate: 40, timeHr: 18, atsCost: 250, jobboardCost: 1200, badHireCost: 45, badHireRate: 19 }
        };

        const plans = [
            { name: 'TPE Pay-per-use', price: 149, maxJobs: 1, perJob: true },
            { name: 'Core', price: 249, maxJobs: 3 },
            { name: 'Premium', price: 449, maxJobs: 5 },
            { name: 'Premium Plus', price: 799, maxJobs: 10 },
            { name: 'Grands Comptes', price: 1500, maxJobs: 999 }
        ];

        let debugMode = false;

        // Company selection
        document.querySelectorAll('.company-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.company-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const type = this.dataset.type;
                const profile = profiles[type];
                
                document.getElementById('jobs').value = profile.jobs;
                document.getElementById('salary').value = profile.salary;
                document.getElementById('method').value = profile.method;
                document.getElementById('cost').value = profile.cost;
                document.getElementById('hrRate').value = profile.hrRate;
                document.getElementById('timeHr').value = profile.timeHr;
                document.getElementById('badHireCost').value = profile.badHireCost;
                document.getElementById('badHireRate').value = profile.badHireRate;
                
                document.getElementById('method').setAttribute('data-ats-cost', profile.atsCost);
                document.getElementById('method').setAttribute('data-jobboard-cost', profile.jobboardCost);
                
                updateMethodLabels();
                document.getElementById('params').classList.remove('hidden');
                calculate();
            });
        });

        // Input listeners
        ['jobs', 'salary', 'method', 'cost', 'hrRate', 'timeHr', 'badHireCost', 'badHireRate'].forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('input', calculate);
            }
        });

        document.getElementById('method').addEventListener('change', function() {
            updateMethodLabels();
            calculate();
        });

        function updateMethodLabels() {
            const method = document.getElementById('method').value;
            const costLabel = document.getElementById('costLabel');
            const costHelp = document.getElementById('costHelp');
            const costInput = document.getElementById('cost');
            const methodElement = document.getElementById('method');
            
            if (method === 'cabinet') {
                costLabel.textContent = 'Commission (%)';
                costHelp.textContent = 'Taux de commission moyen';
                if (!costInput.value || costInput.value > 50) {
                    costInput.value = 18;
                }
            } else if (method === 'ats') {
                costLabel.textContent = 'Coût ATS (€/recrutement)';
                costHelp.textContent = 'Abonnement ATS ramené par recrutement';
                const atsCost = methodElement.getAttribute('data-ats-cost') || 200;
                costInput.value = atsCost;
            } else {
                costLabel.textContent = 'Coût jobboards (€/recrutement)';
                costHelp.textContent = 'Annonces jobboards + CVthèques';
                const jobboardCost = methodElement.getAttribute('data-jobboard-cost') || 1000;
                costInput.value = jobboardCost;
            }
        }

        function selectPlan(jobs) {
            // Sélection du plan basé sur le volume ANNUEL de recrutements
            if (jobs <= 1) return plans[0]; // Pay-per-use pour 1 recrutement
            if (jobs <= 12) return plans[1]; // Core jusqu'à 12/an (1/mois en moyenne)
            if (jobs <= 24) return plans[2]; // Premium jusqu'à 24/an (2/mois en moyenne)
            if (jobs <= 48) return plans[3]; // Premium Plus jusqu'à 48/an (4/mois en moyenne)
            return plans[4]; // Grands comptes
        }

        function calculate() {
            const jobs = parseInt(document.getElementById('jobs').value) || 0;
            const salary = parseInt(document.getElementById('salary').value) || 0;
            const method = document.getElementById('method').value;
            const cost = parseFloat(document.getElementById('cost').value) || 0;
            const hrRate = parseFloat(document.getElementById('hrRate').value) || 0;
            const timeHr = parseFloat(document.getElementById('timeHr').value) || 0;
            const badHireCost = parseFloat(document.getElementById('badHireCost').value) * 1000 || 30000;
            const badHireRate = parseFloat(document.getElementById('badHireRate').value) || 15;

            if (jobs === 0 || salary === 0) return;

            // === CALCULS MÉTHODE ACTUELLE ===
            let currentMethodCost = 0;
            let methodTitle = '';
            let currentBreakdown = '';
            
            if (method === 'cabinet') {
                // Cabinet: Commission + temps RH limité (5h)
                const commissionCost = jobs * salary * 1000 * (cost / 100);
                const hrCost = jobs * 5 * hrRate; // Cabinet = seulement 5h RH
                currentMethodCost = commissionCost + hrCost;
                methodTitle = '👔 Cabinet de recrutement';
                currentBreakdown = `Commission: ${commissionCost.toLocaleString('fr-FR')}€ + RH (${jobs * 5}h): ${hrCost.toLocaleString('fr-FR')}€`;
            } else if (method === 'ats') {
                // ATS: Coût ATS + MÊME budget jobboards que l'interne + temps RH réduit de 20%
                const atsCost = jobs * cost; // Abonnement ATS
                // Pour les jobboards, on utilise le coût jobboards du profil sélectionné
                const activeProfile = document.querySelector('.company-btn.active');
                let baseJobboardCost = 1000; // Défaut
                if (activeProfile) {
                    const profileData = profiles[activeProfile.dataset.type];
                    baseJobboardCost = profileData.jobboardCost; // Utiliser le coût jobboards spécifique
                }
                const jobboardCost = jobs * baseJobboardCost;
                const reducedTimeHr = Math.round(timeHr * 0.8); // 20% de temps économisé seulement
                const hrCost = jobs * reducedTimeHr * hrRate;
                currentMethodCost = atsCost + jobboardCost + hrCost;
                methodTitle = '💻 Interne + jobboards + ATS';
                currentBreakdown = `ATS: ${atsCost.toLocaleString('fr-FR')}€ + Jobboards: ${jobboardCost.toLocaleString('fr-FR')}€ + RH (${jobs * reducedTimeHr}h): ${hrCost.toLocaleString('fr-FR')}€`;
            } else {
                // Interne: Jobboards pleins + temps RH complet
                const jobboardCost = jobs * cost;
                const hrCost = jobs * timeHr * hrRate;
                currentMethodCost = jobboardCost + hrCost;
                methodTitle = '📄 Interne + jobboards';
                currentBreakdown = `Jobboards: ${jobboardCost.toLocaleString('fr-FR')}€ + RH (${jobs * timeHr}h): ${hrCost.toLocaleString('fr-FR')}€`;
            }

            // === TAUX D'ÉCHEC PAR MÉTHODE ===
            let methodBadHireRate = badHireRate;
            if (method === 'cabinet') {
                methodBadHireRate = 15; // Cabinet 15%
            } else if (method === 'ats') {
                methodBadHireRate = 13; // ATS 13%
            } else {
                methodBadHireRate = Math.max(15, badHireRate); // Interne minimum 15%
            }

            // === COÛTS MAUVAIS RECRUTEMENTS ===
            const currentBadHireCost = jobs * (methodBadHireRate / 100) * badHireCost;
            const tenexBadHireRate = 6; // Tenex constant à 6%
            const tenexBadHireCost = jobs * (tenexBadHireRate / 100) * badHireCost;

            // === COÛT TOTAL MÉTHODE ACTUELLE ===
            const totalCurrentCost = currentMethodCost + currentBadHireCost;

            // === CALCULS TENEX ===
            const plan = selectPlan(jobs);
            let tenexSubscriptionCost = 0;
            
            if (plan.perJob) {
                // Pay-per-use
                tenexSubscriptionCost = jobs * plan.price;
            } else {
                // Abonnement mensuel
                tenexSubscriptionCost = plan.price * 12;
            }
            
            const tenexHrCost = jobs * 6 * hrRate; // 6h RH avec Tenex
            const tenexMethodCost = tenexSubscriptionCost + tenexHrCost;
            const totalTenexCost = tenexMethodCost + tenexBadHireCost;

            // === CALCUL ROI ===
            const totalSavings = totalCurrentCost - totalTenexCost;
            const roi = tenexSubscriptionCost > 0 ? (totalSavings / tenexSubscriptionCost * 100) : 0;
            const roiMultiplier = tenexSubscriptionCost > 0 ? (totalSavings / tenexSubscriptionCost) : 0;

            // === DEBUG INFO ===
            if (debugMode) {
                const debugText = `
                    Jobs: ${jobs} | Salary: ${salary}k€ | Method: ${method}<br>
                    Current method cost: ${currentMethodCost.toLocaleString('fr-FR')}€<br>
                    Current bad hire cost (${methodBadHireRate}%): ${currentBadHireCost.toLocaleString('fr-FR')}€<br>
                    <strong>Total current: ${totalCurrentCost.toLocaleString('fr-FR')}€</strong><br><br>
                    Plan: ${plan.name} | Subscription: ${tenexSubscriptionCost.toLocaleString('fr-FR')}€<br>
                    Tenex method cost: ${tenexMethodCost.toLocaleString('fr-FR')}€<br>
                    Tenex bad hire cost (${tenexBadHireRate}%): ${tenexBadHireCost.toLocaleString('fr-FR')}€<br>
                    <strong>Total Tenex: ${totalTenexCost.toLocaleString('fr-FR')}€</strong><br><br>
                    Savings: ${totalSavings.toLocaleString('fr-FR')}€ | ROI: ${roi.toFixed(1)}%
                `;
                document.getElementById('debugText').innerHTML = debugText;
            }

            updateResults(totalCurrentCost, totalTenexCost, tenexSubscriptionCost, plan, methodTitle, 
                         jobs, badHireCost, currentBadHireCost, tenexBadHireCost, methodBadHireRate, tenexBadHireRate,
                         currentBreakdown, roi, roiMultiplier);
        }

        function updateResults(currentTotal, tenexTotal, tenexSubscription, plan, methodTitle, 
                             jobs, badHireCost, currentBadHireCost, tenexBadHireCost, currentBadHireRate, tenexBadHireRate,
                             currentBreakdown, roi, roiMultiplier) {
            
            // === UPDATE ROI DISPLAY ===
            const roiHighlight = document.getElementById('roiHighlight');
            const roiValue = document.getElementById('roiValue');
            const roiSubtitle = document.getElementById('roiSubtitle');
            
            if (roi > 0) {
                roiHighlight.className = 'roi-highlight';
                roiValue.textContent = `+${Math.round(roi)}%`;
                roiSubtitle.textContent = `Pour chaque 1€ investi, vous économisez ${roiMultiplier.toFixed(1)}€`;
            } else {
                roiHighlight.className = 'roi-highlight negative';
                roiValue.textContent = `${Math.round(roi)}%`;
                roiSubtitle.textContent = `Tenex coûte ${Math.abs(roiMultiplier).toFixed(1)}€ de plus par euro investi`;
            }

            // === UPDATE COMPARISON ===
            document.getElementById('currentMethodTitle').textContent = methodTitle;
            document.getElementById('currentCost').textContent = (currentTotal - currentBadHireCost).toLocaleString('fr-FR') + ' €';
            document.getElementById('currentBreakdown').innerHTML = currentBreakdown;
            document.getElementById('tenexCost').textContent = (tenexTotal - tenexBadHireCost).toLocaleString('fr-FR') + ' €';

            // === UPDATE BAD HIRE SECTION ===
            const badHireCalc = document.getElementById('badHireCalc');
            badHireCalc.innerHTML = `
                Avec votre méthode actuelle : ${currentBadHireRate}% d'échec × ${jobs} recrutements × ${(badHireCost/1000).toFixed(0)}k€ = <span class="bad-hire-savings">${currentBadHireCost.toLocaleString('fr-FR')} €</span> de risque/an
                <br>Avec Tenex (${tenexBadHireRate}% d'échec grâce à l'IA) : <span class="bad-hire-savings">${tenexBadHireCost.toLocaleString('fr-FR')} €</span> de risque/an
                <br><strong>Économie sur le risque : ${(currentBadHireCost - tenexBadHireCost).toLocaleString('fr-FR')} €/an</strong>
            `;

            // === UPDATE PLAN DETAILS ===
            document.getElementById('planName').textContent = `${plan.name}`;
            document.getElementById('planDetails').textContent = plan.perJob ? 
                `${plan.price}€ par recrutement • Pay-per-use` : 
                `${plan.price}€/mois • Jusqu'à ${plan.maxJobs} postes actifs`;

            document.getElementById('result').classList.remove('hidden');
        }

        function toggleDebug() {
            debugMode = !debugMode;
            const debugInfo = document.getElementById('debugInfo');
            debugInfo.style.display = debugMode ? 'block' : 'none';
            if (debugMode) calculate();
        }

        function showMethodology() {
            document.getElementById('methodologyPopup').style.display = 'flex';
        }

        function hideMethodology() {
            document.getElementById('methodologyPopup').style.display = 'none';
        }

        function trackCTA() {
            console.log('CTA clicked - Demo request');
            window.open('https://calendly.com/tenex-demo', '_blank');
        }

        // Close popup when clicking outside
        document.getElementById('methodologyPopup').addEventListener('click', function(e) {
            if (e.target === this) {
                hideMethodology();
            }
        });
    </script>
</body>
</html>
